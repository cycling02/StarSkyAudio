## 播放状态持久化功能实现计划

### 1. 添加 DataStore 依赖
- 在 `gradle/libs.versions.toml` 中添加 DataStore 版本（1.1.1）
- 在 `starsky/build.gradle.kts` 中添加 DataStore Preferences 依赖

### 2. 创建持久化管理类
创建 `StarSkyPreferencesManager.kt` 类，包含：
- DataStore 初始化
- 持久化数据定义：
  - 当前播放音频信息（songId, songUrl, songName, artist, albumName, coverUrl）
  - 播放位置（position）
  - 播放模式（PlayMode）
  - 音量（volume）
  - 播放速度（speed）
  - 播放列表（JSON 格式存储）
  - 当前播放索引（currentIndex）
- 保存和读取方法
- 清除数据方法

### 3. 在 StarSkyPlayer 中集成持久化
- 添加 `StarSkyPreferencesManager` 实例
- 在播放状态变化时自动保存：
  - 播放新音频时保存音频信息
  - 播放进度变化时保存位置（节流，避免频繁写入）
  - 播放模式变化时保存模式
  - 音量变化时保存音量
  - 播放速度变化时保存速度
  - 播放列表变化时保存列表和索引

### 4. 在 StarSky.kt 中添加恢复接口
- `restorePlaybackState()` - 恢复上次播放状态
- `clearPlaybackState()` - 清除持久化的播放状态

### 5. 更新 README.md
- 添加持久化功能说明
- 添加使用示例

### 技术要点
- 使用 Preferences DataStore（适合小型键值对数据）
- 使用 Flow 监听数据变化
- 播放位置使用节流（每 1 秒保存一次）
- 播放列表使用 JSON 序列化存储